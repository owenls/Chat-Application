{% extends "base.html" %} {% block title %}Home{% endblock %}

{% block mycss%}

<link rel="stylesheet" href="{{ url_for('static', filename='css/general.css') }}"/>
<link rel="stylesheet" href="{{ url_for('static', filename='css/home.css') }}"/>
<link rel="stylesheet" href="{{ url_for('static', filename='css/scoreboard.css') }}"/>
<link rel="stylesheet" href="{{ url_for('static', filename='css/user_lists.css') }}"/>



{% endblock mycss%}

{% block content %} 


<div class="home-wrapper">
    <div class="row">
        <div class="col-12 col-md-3" id="leftDiv">
            <div id="profileTopLeft">
                <div class="topLeftProfilePictureDiv">
                    <img src={{user.profile_picture}} class="topLeftProfilePicture" alt="Profile Picture">
                </div>
                
                <div class="userDetails">
                    <p><b>User:</b> </p>
                    <p>{{ user.username }}</p>
                    <p><b>Score:</b></p>
                    <p>{{ user.score }}</p>
                </div>
            </div>
            <button class="btn btn-primary d-md-none" id="favouritesButton">
                Favourites
            </button>
            <div id="favouritesCollapse">
                <!-- Below includes the code in favourites.html -->
                {% include "favourites.html" %}
            </div>
            
        </div>

        <div class="col-12 col-md-6" id="middleDiv">
            
                <!-- Below includes the code in scoreboard.html -->
                {% include "scoreboard.html" %}
            
            <hr>
            <button class="btn btn-primary d-md-none" id="collapseButton">
                Public Chat Rooms
            </button>
            <div id="publicAllCollapse">
                <div class="publicAll"> 
                    <div class="headers">
                        <h2>Public Chat Rooms</h2>
                    </div>
                    <form method="post" class="buttons" id="publicChats">
                        <div>
                            <input type="text"  name="name" value="{{ user.username }}" hidden>
                        </div>
                        <div id="chatButtons">
                            <button type="submit" name="globalChat" class="chatLink">Global Chat</button>
                            <button type="submit" name="lfgChat" class="chatLink">Looking for Group Chat</button>
                            <button type="submit" name="supportChat" class="chatLink">Support Chat</button>
                        </div>
                    </form>

                    <hr>
                    <div class="headers">
                        <h4>Join or Create a Private Room</h4>
                    </div>
                    <form method="post" class="buttons">
                        <div class="join">
                            <div id="codeInput">
                                <input type="text" placeholder="Enter a Room Code" name="code" value="{{code}}">
                            </div>
                            <div id="errorFeedback">
                                {% if error %}
                                    <p id="errorMsg">{{error}}</p>
                                {% endif %}
                            </div>  
                            <div id="join-and-create">
                                <Button type="submit" name="join" id="join-btn">Join a Room</Button>            
                                <Button type="submit" name="create" id="create-btn">Create New Room</Button>
                            </div>
                            
                                
                        </div>
                    </form>
                </div>
            </div>
        </div>
        <div class="col-12 col-md-3" id="rightDiv">
            <!-- Below includes the code in members.html -->
            {% include "members.html" %}

            
        </div>        
    </div>
</div>

{% endblock %}

<!-- 
<div>
    <td>
        <form action="{{ url_for('auth.score_up') }}" method="post">
        <input type="hidden" name="score_up" value="1"/>
        <input type="submit" value="Score + 1"/>
        </form>
    </td>
</div> 
-->

{% block bottom_script %} 

<script>

    var favouritesButton = document.getElementById("favouritesButton");
    var favouritesCollapse = document.getElementById("favouritesCollapse");

    var collapseButton = document.getElementById("collapseButton");
    var publicAllCollapse = document.getElementById("publicAllCollapse");


    // Initially hide on small screens
    if(window.innerWidth < 768){
        favouritesCollapse.style.display = "none";
        publicAllCollapse.style.display = "none";
    }

    favouritesButton.addEventListener("click", function(){
        if(favouritesCollapse.style.display === "none"){
            favouritesCollapse.style.display = "block";
        } else {
            favouritesCollapse.style.display = "none";
        }
    });

    // Add click event listener
    collapseButton.addEventListener("click", function(){
        if(publicAllCollapse.style.display === "none"){
            publicAllCollapse.style.display = "block";
        } else {
            publicAllCollapse.style.display = "none";
        }
    });

    // Handle screen resize
    window.addEventListener("resize", function() {
        if(window.innerWidth >= 768){
            favouritesCollapse.style.display = "block";
            publicAllCollapse.style.display = "block";
        } else if (!collapseButton.clicked){
            favouritesCollapse.style.display = "none";
            publicAllCollapse.style.display = "none";
        }
    });
</script>

{% endblock bottom_script %}